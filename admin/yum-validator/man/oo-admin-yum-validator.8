.\" Text automatically generated by txt2man
.TH oo-admin-yum-validator 8 "12 November 2014" "" ""
.SH NAME
\fB
\fBoo-admin-yum-validator
\fB
.SH SYNOPSIS
.nf
.fam C

\fBoo-admin-yum-validator\fP [\fB--help\fP]
  [\fB--role\fP system_role,\.\.\.]
  [\fB--oo-version\fP \fIopenshift_version\fP]
  [\fB--subscription-type\fP \fIsubscription_type\fP]
  [\fB--fix\fP|\fB--fix-all\fP|\fB--report-all\fP]
  [\fB--repo-config\fP \fIrepo_config\fP]

.fam T
.fi
.fam T
.fi
.SH DESCRIPTION

\fBoo-admin-yum-validator\fP attempts to validate repository priorities
and availability to ensure OpenShift dependencies are available and
preferred over packages from other repositories.
.SH OPTIONS

.TP
.B
\fB-h\fP|\fB--help\fP
Show help message and exit
.TP
.B
\fB-r\fP|\fB--role\fP system_role
Valid arguments: node, broker, client, node-eap
.RS
.PP
OpenShift component \fBrole\fP(s) this system will fulfill. This option
may be specified more than once
.PP
Note that \fB--role\fP=node-eap implies \fB--role\fP=node, and \fB--role\fP=broker
implies \fB--role\fP=client
.RE
.TP
.B
\fB-o\fP|\fB--oo-version\fP \fIopenshift_version\fP
Example arguments: 1.2, 2.0, 2.0beta, \.\.\.
.RS
.PP
Version of OpenShift in use on this system. Valid arguments are
derived from the product_version fields of repositories defined in
the default repository configuration file
(/etc/yum-validator/repos.ini) or from the configuration file
specified via the \fB--repo-config\fP option
.RE
.TP
.B
\fB-s\fP|\fB--subscription-type\fP \fIsubscription_type\fP
Valid arguments: rhsm, rhn
.RS
.PP
Subscription management system which provides the OpenShift
repositories/channels.
.RE
.TP
.B
\fB-f\fP|\fB--fix\fP
Attempt to repair the first problem found
.TP
.B
\fB-a\fP|\fB--fix-all\fP
Attempt to repair all problems found
.TP
.B
\fB-p\fP|\fB--report-all\fP
Report all problems (default is to halt after first problem
report)
.TP
.B
\fB-c\fP|\fB--repo-config\fP \fIrepo_config\fP
Load repository configuration data from the specified file
\fIrepo_config\fP instead of the default file
/etc/yum-validator/repos.ini
.TP
.B
\fB-e\fP|\fB--reconcile-overrides\fP
Checks RHSM repos for local settings that differ from
settings stored remotely as content overrides, and
commutes the local values to content overrides.
.RE
.PP

.SH APPLICATION USAGE

With no arguments, \fBoo-admin-yum-validator\fP will attempt to guess various details about your system, including:
.IP 1. 4
What OpenShift component role or roles the system is configured to fulfill
.IP 2. 4
Which version, if any, of OpenShift is currently installed
.IP 3. 4
Which subscription management or entitlement system is in use (e.g. Red Hat Subscription Manager/RHSM)
.PP
These details are determined by examining what repositories/channels are currently enabled and what OpenShift packages are installed. If one or more of these details can't be guessed, \fBoo-admin-yum-validator\fP will exit with a message to that effect. These details can be supplied by the user via the \fB--role\fP, \fB--oo-version\fP and \fB--subscription-type\fP options. User-supplied information takes precedence over guessed details.
.PP
Once the role, version and subscription details are available, \fBoo-admin-yum-validator\fP performs a series of checks to make sure that OpenShift packages and their dependencies are coming from the appropriate repositories. These checks validate the following requirements:
.IP 1. 4
OpenShift repositories and known dependency-providing repositories which are required for the guessed or specified roles are available
.IP 2. 4
Required repositories are enabled
.IP 3. 4
The yum-plugin-priorities package is installed
.IP 4. 4
Required repositories' relative priorities conform to a prescribed order
.IP 5. 4
Any OpenShift repositories which don't match the version or subscription type specified are disabled
.IP 6. 4
Any enabled repositories which provide packages that conflict with those provided from required repositories have a priority that prevents the conflicting packages from taking precedence
.IP 7. 4
Required repositories have pre-defined package exclusions configured
.PP
The four principle usage modes for \fBoo-admin-yum-validator\fP are as follows:
.SS  ITERATIVE REPORT USAGE

Without specifying \fB--fix\fP, \fB--fix-all\fP, or \fB--report-all\fP, the default behavior for yum-validator is to:
.IP \(bu 3
Output a message explaining the problem
.IP \(bu 3
Detail steps to resolve the problem manually
.IP \(bu 3
Immediately exit with an error code
.PP
Once the fix is attempted, \fBoo-admin-yum-validator\fP can be run again to determine if the problem has been resolved, and if any other problems remain. This validate-fix-validate cycle is useful when building deployment automation configurations, e.g. with Puppet.
.SS  ITERATIVE FIX USAGE

Specifying \fB--fix\fP will cause \fBoo-admin-yum-validator\fP to attempt to repair the first problem class it detects, at which point it outputs a message explaining the problem and the steps taken to repair it, and exits with an error code. Subsequent runs with the \fB--fix\fP option will repair problems one at a time until no more problems are detected.
.SS  REPORT ALL USAGE

The \fB--report-all\fP option leads \fBoo-admin-yum-validator\fP to make a best-effort analysis of all possible problems without fixing them. The same caveat regarding incorrect problem detection from \fB--fix-all\fP applies here. The result of fixing one problem may impact the detection or interpretation of one or more following problems.
.PP
By buffering the output and checking the exit code, this option can be used to hook \fBoo-admin-yum-validator\fP into system monitoring services.
.SS  FIX ALL USAGE

If the \fB--fix-all\fP option is provided will repair all detected problems in one shot. If no problems are detected, \fBoo-admin-yum-validator\fP will exit normally. If any problems were detected and fixed, an error code is generated. This can pose a very small risk; in the event that a problem is incorrectly detected, \fBoo-admin-yum-validator\fP will attempt the fix anyway.
.PP
Cautious users should prefer the iterative fix usage offered by \fB--fix\fP over \fB--fix-all\fP.
.RE
.PP

.SH EXIT STATUS

.TP
.B
0
No problems were detected
.TP
.B
1
At least one problem detected
.SH EXAMPLE

On a fresh system with subscriptions managed via RHSM and no OpenShift installation, determine what changes need to happen in order to configure the system as an OpenShift broker:
.PP
.nf
.fam C
    # oo-admin-yum-validator \\
        --subscription-type=rhsm \\
        --oo-version=2.0 \\
        --role=broker

.fam T
.fi
As a system administrator, you're responding to a report that mentions only "an OpenShift server isn't working". You're logged into the system; to make a best-guess at what version of OpenShift is installed and what role the system is configured for:
.PP
.nf
.fam C
    # oo-admin-yum-validator

.fam T
.fi
\fBoo-admin-yum-validator\fP reports that the system has roles node and node-eap, that it's subscribed via RHN and the OpenShift version is 2.0. It also reports that a third-party repository conflicts with the official OpenShift repositories. You use this information to amend your configuration management profile for OpenShift systems and set the priority of the new repository to the suggested value. You refresh the system with the configuration management tool and then run \fBoo-admin-yum-validator\fP again to verify that no problems remain:
.PP
.nf
.fam C
    # oo-admin-yum-validator \\
        --subscription-type=rhn \\
        --oo-version 2.0 \\
        --role=node-eap \\
        --role=node

.fam T
.fi
.SH WARNINGS

Support for OpenShift Origin based installs is preliminary. Most documentation and examples are based around the OpenShift Enterprise installation experience, and may be of varying applicability for Origin.
.PP
Installations where the repositories are "plain old" Yum repositories are only implemented for OpenShift Origin at this point; custom repository setups can be accounted for by modifying /etc/repos.ini or providing your own.
.PP
Subscriptions provided via RHN Satellite are untested, and only stand a chance of working if the channel names match those of the corresponding channels provided through RHN Classic.
.SH SEE ALSO

\fBoo-admin-chk\fP(8), \fBoo-accept-broker\fP(8), \fBoo-accept-systems\fP(8),
\fBoo-accept-node\fP(8), \fBoo-diagnostics\fP(8), \fBrhn-channel\fP(8),
\fBsubscription-manager\fP(8), \fByum-utils\fP(1)
.SH AUTHOR
John Lamb <jolamb@redhat.com> - man page written for OpenShift
