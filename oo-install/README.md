# oo-install
This package is a general-purpose installation tool for [OpenShift](http://www.openshift.com/). It supports a number of deployment scenarios and is extensible through the definition of installer Workflows.

## Installation
The latest stable version of the installer is available for "curl-to-shell" use from the OpenShift cloud. To use it, run:

    sh <(curl -s https://install.openshift.com/)

from the command line of any system with ruby 1.8.7 or above plus unzip and curl. Depending on what you are trying to install (OpenShift Origin versus OpenShift Enterprise), your target system may require additional RPMs. The installer will attempt to suggest RPM packages to install to provide the necessary utilities.

## Running oo-install from source
If you would prefer to run the installer from source, you will need to use the [bundler](http://bundler.io/) gem to set up the right environment.

1. `gem install bundler --version '=1.7.8'`
2. Clone [openshift-extras](https://github.com/openshift/openshift-extras/)
3. `cd openshift-extras/oo-install`
4. `bundle install`
5. `bundle exec bin/oo-install`

## Command-line options

The following command-line options are currently supported:

    -a, --advanced-mode              Enable access to message server and db server customization.
    -c, --config-file FILEPATH       The path to an alternate config file
        --create-config              Use with "-c" to create and use a new alternate config file
    -w, --workflow WORKFLOW_ID       The installer workflow for unattended deployment.
    -e, --enterprise-mode            Show OpenShift Enterprise options (ignored in unattended mode)
        --openshift-version VERSION  Specify the version of OpenShift to be installed (default is latest)
    -s, --subscription-type TYPE     The software source for installation packages.
    -u, --username USERNAME          Red Hat Login username
    -p, --password PASSWORD          Red Hat Login password

- - -

**NOTE**:  
In order to pass arguments to the curl-to-shell command, enclose them in quotes.

    sh <(curl -s https://install.openshift.com/) "-c alternate/config/file.yml -w origin_add_node -s yum"

- - -

## Packaging for [install.openshift.com](https://install.openshift.com/)
The `oo-install` codebase includes two Rake tasks:

* package
* clean

These can be invoked from a command line:

    cd openshift-extras/oo-install
    bundle exec rake <operation>

The `package` task builds several different distributions of `oo-install` and organizes them under `openshift-extras/oo-install/package`. The resulting directory structure is used by a local copy of the `oo-install.rhcloud.com` app repo to update the contents of the site. If the environment variable APP_URL is set, then APP_URL will be used in place of install.openshift.com on the generated HTML pages.

To extend the list of packages generated by the `package` task, refer to the `builds` hash within the `package` task definition in the [Rakefile](https://github.com/openshift/openshift-extras/blob/master/oo-install/Rakefile). The hashes in this list contain up to five keys:

* **:version** - A context/version tag in the form '[[context]]-[[version]]'. This is used to create a subdirectory and subpackage on the site; for instance a value of 'ose-2.0' causes the installer to build a package that will be served at [https://installer.openshift.com/ose-2.0]()
* **:version_text** - Human-readable version information; this will be shown in the `oo-install` title when the application starts.
* **:context** - This value presets the behavior of the installer. A value of '`:ose`' here is equivalent to setting '-e' as a command-line argument to the installer.
* **:ose_launcher** - This optional setting provides the URL of an alternate copy of `openshift.sh` to use for OSE workflows in this package. This is part of how the installer site solves version management.
* **:portable_only** - This site builds distribution packages for the OpenShift Origin VM (`:context => :origin_vm`). These packages are only meaningful in the context of the VM, so by setting the `:portable_only` boolean to `true`, we create a portable distribution of the VM's installer package but _do not_ create a site version.
* **:base** - This boolean is only used for the root build definition; it should be omitted or `false` in any other build defs.

## Contributing

1. Fork it
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create new Pull Request
